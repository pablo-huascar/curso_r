---
title: "R para análise de dados em Psicologia"
subtitle: "Uma Introdução"
execute:
  echo: true
author: "Francisco Pablo Huascar Aragão Pinheiro"
institute: <img src="images/ufc_horizontal.png" width="250">
format: 
  revealjs:
      theme: simple
      fig-width: 6
      fig-asp: 0.618
progress: true
slide-number: true
logo: images/lappsie.png
editor: visual
editor_options: 
  chunk_output_type: console
---

## Quem sou eu

::: columns
::: {.column width="40%"}
![](images/logo_pos.png) ![](images/lappsie.png)
:::

::: {.column width="60%"}
::: incremental
-   [Psicólogo]{style="font-size:25pt;"}
-   [Doutor em educação]{style="font-size:25pt;"}
-   [Professor do campus Sobral da UFC]{style="font-size:25pt;"}
-   [Recentemente, um entusiasta do R]{style="font-size:25pt;"}
:::
:::
:::

::: aside
Meu [currículo lattes](http://lattes.cnpq.br/8266089190930601): acesse [aqui](http://lattes.cnpq.br/8266089190930601)
:::

# Gráficos

##  {#slide2-id data-menu-title="Barras" transition="slide"}

![](images/barplot.png)

##  {#slide3-id data-menu-title="Caixa e bigodes" transition="fade"}

![](images/boxplot.png)

##  {#slide4-id data-menu-title="Dispersão" transition="convex" transition-speed="slow"}

![](images/scaterplot.png)

##  {#slide6-id data-menu-title="Histograma"}

![](images/histogram.png)

## R for Data Science

::: columns
::: {.column width="50%"}
Livro base para o mini curso
:::

::: {.column width="50%"}
[![](images/r_for_d_s.jpg){fig-alt="Capa do livro R for Data Science. Uma coruja se destaca na ilustração" fig-align="right" width="412"}](https://r4ds.had.co.nz/)
:::
:::

## R for Data Science

-   Neste [link](https://r4ds.had.co.nz/ "R for Data Science") você pode acessar a primeira edição do livro:

<https://r4ds.had.co.nz/>

-   E [aqui](https://r4ds.hadley.nz/ "R for Data Science") você pode acessar a segunda edição que ainda está sendo finalizada:

<https://r4ds.hadley.nz/>

::: aside
Estes slides tem como base o conteúdo da segunda edição
:::

## ggplot2: Elegant Graphics for Data Analysis

::: columns
::: {.column width="50%"}
Para apronfundar o conhecimento sobre gráficos
:::

::: {.column width="50%"}
[![](images/ggplot.jpg){fig-align="right" width="380"}](https://r4ds.had.co.nz/)
:::
:::

## ggplot2: Elegant Graphics for Data Analysis

-   Neste [link](https://ggplot2-book.org/index.html "ggplot2: Elegant Graphics for Data Analysis") você pode acessar a terceira edição do livro que ainda está sendo finalizada:

<https://ggplot2-book.org/index.html>

# 2 Visualização de Dados

## 2.1 Introdução

-   [ggplot2](https://ggplot2.tidyverse.org/): grammar of graphics (gramática dos gráficos)
    -   [Sistema coerente para descrever e construir gráficos]{style="font-size:20pt;"}

::: panel-tabset
### `data`

```{r}
#| echo: false
#| out-width: 35%
library(ggplot2)
library(palmerpenguins)

penguins |> 
  ggplot()
```

### `mapping`

```{r}
#| echo: false
#| out-width: 35%
penguins |> 
  ggplot(aes(flipper_length_mm, 
             body_mass_g))
```

### `geom_`

```{r}
#| echo: false
#| out-width: 35%
penguins |> 
  ggplot(aes(flipper_length_mm, 
             body_mass_g))+
  geom_point()
```
:::

## Pacotes

```{r}
#| message: true
#| warning: true

library(tidyverse)
```

[`there is no package called 'tidyverse'`]{style="font-size:20pt;"}

```{r}
#| message: false
#| eval: false
install.packages("tidyverse")
library(tidyverse)
```

```{r}
library(palmerpenguins)
library(ggthemes)
```

##  {#slide7-id data-menu-title="Pinguins" background-image="images/pinguins.png"}

## 2.2 Primeiros Passos

::: incremental
-   Os pinguins com nadadeiras mais longas pesam mais ou menos que os pinguins com nadadeiras mais curtas?
-   Como é a relação entre o comprimento da nadadeira e a massa corporal? É positivo? Negativo? Linear? Não linear?
-   A relação varia de acordo com a espécie do pinguim?
-   O que nos diz a ilha onde mora o pinguim?
-   Vamos criar visualizações que podemos usar para responder a essas perguntas.
:::

## O banco de Dados dos [`penguins`](https://allisonhorst.github.io/palmerpenguins/)

-   Bando de dados: uma coleção retangular de variáveis (nas colunas) e observações (nas linhas)
-   `penguins`: `r nrow(penguins)` casos/observações
-   Os dados foram coletados e disponibilizados pela Dra. Kristen Gorman e a Estação Palmer, Antártica LTER

## Algumas Definições

::: incremental
-   **Variável**: uma quantidade, qualidade ou propriedade que você pode medir
-   **Valor**: o estado de uma variável quando você a mede
    -   [O valor de uma variável pode mudar de medição para medição]{style="font-size:20pt;"}
:::

## Algumas Definições

::: incremental
-   **Observação/caso**: conjunto de medições feitas em condições semelhantes
    -   [Todas as medições em uma observação são feitas ao mesmo tempo e no mesmo objeto]{style="font-size:20pt;"}
-   Uma observação/caso conterá vários valores, cada um associado a uma variável diferente.
-   `penguins`
    -   [Variável: atributo de todos os pinguins]{style="font-size:20pt;"}
    -   [Observação: todos os atributos de um único pinguim]{style="font-size:20pt;"}
:::

## Dados Tabulares

::: incremental
-   Conjunto de valores, cada um associado a uma variável e a uma observação.
-   Os dados tabulares são organizados ("tidy") se cada valor for colocado em sua própria "célula", cada variável em sua própria coluna e cada observação em sua própria linha
:::

## Tidy data

![](images/tidy.png)

## [`tibble`](https://tibble.tidyverse.org/)

```{r}
#| echo: true
penguins
```

-   Oito colunas (variáveis)

## Variáveis

```{r}
glimpse(penguins)

```

## Variáveis

```{r}
#| eval: false
View(penguins)
```

![](images/view.png)

## Variáveis no banco de dados dos `penguins`

::: nonincremental
1.  `species`: uma espécie de pinguim (Adelie, Chinstrap ou Gentoo)
2.  `flipper_length_mm`:comprimento da nadadeira de um pinguim, em milímetros
3.  `body_mass_g`:massa corporal de um pinguim, em gramas
:::

Para saber mais sobre o banco de dados:

```{r}
#| eval: false

?penguins
```

## Objetivo final {transition="convex" transition-speed="slow"}

```{r}
#| echo: false
#| message: false
#| warning: false
#| out-width: 70%
#| fig-align: center

penguins |> 
  ggplot(aes(flipper_length_mm, 
             body_mass_g))+
  geom_point(aes(color = species,
                 shape = species))+
  geom_smooth(method = "lm")+
  labs(title = "Massa corporal e comprimento da nadadeira",
       subtitle = "Dimensões para Adelie, Chinstrap e Gentoo",
    x = "Comprimento da nadadeira (mm)",
       y = "Massa corporal (g)",
       color = "Espécie",
    shape = "Espécie")+
  scale_color_colorblind()
```

# Criando um [ggplot](https://ggplot2.tidyverse.org/reference/ggplot.html) camada por camada

## Banco de dados

`data`

```{r}
#| out-width: 60%
#| fig-align: center

ggplot(data = penguins)
```

## Representação visual das informações

`mapping` e `aes`(aesthetics - estética)

```{r}
#| out-width: 55%
#| fig-align: center
#| code-line-numbers: "|2"

ggplot(data = penguins,
       mapping = aes(x = flipper_length_mm, y = body_mass_g))
```

## Como representar as informações?

-   **geom**: o objeto geométrico que um gráfico usa para representar dados
-   Funções que sempre começam com `geom_`
-   Gráficos de barras: [`geom_bar()`](https://ggplot2.tidyverse.org/reference/geom_bar.html)
-   Gráficos de linhas: [`geom_line()`](https://ggplot2.tidyverse.org/reference/geom_path.html)
-   Gráficos de caixa de bigodes: [`geom_boxplot()`](https://ggplot2.tidyverse.org/reference/geom_boxplot.html)
-   Gráficos de dispersão: [`geom_point()`](https://ggplot2.tidyverse.org/reference/geom_point.html)

## [`geom_point()`](https://ggplot2.tidyverse.org/reference/geom_point.html)

```{r}
#| fig-align: center
#| out-width: 60%
#| code-line-numbers: "|3"
ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point()
```

## Mensagem de aviso (Warning message):

> Removed 2 rows containing missing values (`geom_point()`).

## Adicionando uma estética (aesthetics)

[`color`](https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html)

```{r}
#| output-location: slide
#| fig-align: center
#| code-line-numbers: "|4"
#| out-width: 70% 
ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, 
                y = body_mass_g, 
                color = species)) +
  geom_point()
```

## Adicionando uma estética (aesthetics)

`shape`

```{r}
#| output-location: slide
#| fig-align: center
#| code-line-numbers: "|5"
#| out-width: 70% 
ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, 
                y = body_mass_g, 
                color = species,
                shape = species)) +
  geom_point()
```


## Adicionando uma camada (layer)

[`geom_smooth()`](https://ggplot2.tidyverse.org/reference/geom_smooth.html)

```{r}
#| output-location: slide
#| fig-align: center
#| code-line-numbers: "|7"
#| out-width: 70% 
ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, 
                y = body_mass_g, 
                color = species,
                shape = species)) +
  geom_point()+
  geom_smooth(method = "lm")
```

## {#slide8-id data-menu-title="Objetivo Final"}

```{r}
#| echo: false
#| message: false
#| warning: false
#| out-width: 70%
#| fig-align: center

penguins |> 
  ggplot(aes(flipper_length_mm, 
             body_mass_g))+
  geom_point(aes(color = species,
                 shape = species))+
  geom_smooth(method = "lm")+
  labs(title = "Massa corporal e comprimento da nadadeira",
       subtitle = "Dimensões para Adelie, Chinstrap e Gentoo",
    x = "Comprimento da nadadeira (mm)",
       y = "Massa corporal (g)",
       color = "Espécie",
    shape = "Espécie")+
  scale_color_colorblind()
```

## Adicionando uma camada (layer)

[`geom_smooth()`](https://ggplot2.tidyverse.org/reference/geom_smooth.html)

```{r}
#| output-location: slide
#| fig-align: center
#| code-line-numbers: "|4|5"
#| out-width: 70% 
ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, 
                y = body_mass_g)) +
  geom_point(aes(color = species,
                 shape = species))+
  geom_smooth(method = "lm")
```


## Adicionando rótulos (labels)

[`labs()`](https://ggplot2.tidyverse.org/reference/labs.html)

```{r}
#| output-location: slide
#| fig-align: center
#| code-line-numbers: "|7|8|9|10|11|12"
#| out-width: 70% 
ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, 
                y = body_mass_g)) +
  geom_point(aes(color = species,
                 shape = species))+
  geom_smooth(method = "lm")+
  labs(title = "Massa corporal e comprimento da nadadeira",
       subtitle = "Dimensões para Adelie, Chinstrap e Gentoo",
    x = "Comprimento da nadadeira (mm)",
       y = "Massa corporal (g)",
       color = "Espécie",
    shape = "Espécie")
```

# Cores para daltônicos

[ggthemes](https://cran.r-project.org/package=ggthemes)

```{r}
#| output-location: slide
#| fig-align: center
#| code-line-numbers: "|13"
#| out-width: 70% 

ggplot(data = penguins,
  mapping = aes(x = flipper_length_mm, 
                y = body_mass_g)) +
  geom_point(aes(color = species,
                 shape = species))+
  geom_smooth(method = "lm")+
  labs(title = "Massa corporal e comprimento da nadadeira",
       subtitle = "Dimensões para Adelie, Chinstrap e Gentoo",
    x = "Comprimento da nadadeira (mm)",
       y = "Massa corporal (g)",
       color = "Espécie",
    shape = "Espécie")+
  scale_color_colorblind()
```

## Exercícios

Qual o número de linhas no banco de dados dos `penguins`? Quantas colunas?

## Resposta

```{r}
#| warning: false
#| message: false
library(tidyverse)
library(palmerpenguins)

glimpse(penguins)
```

## Exercícios

Faça um gráfico de dispersão de `bill_depth_mm` vs. `bill_length_mm`. Ou seja, faça um gráfico de dispersão com `bill_depth_mm` no eixo y e `bill_length_mm` no eixo x. Descreva a relação entre essas duas variáveis. 

bill = bico

## Resposta

```{r}
#| fig-align: center
ggplot(data = penguins,
       aes(x = bill_length_mm,
           y = bill_depth_mm))+
  geom_point()+
  geom_smooth()
```

## Exercícios

O que acontece se você fizer um gráfico de dispersão de `species` versus `bill_depth_mm`? O que poderia ser uma melhor escolha de geom?

## Resposta

```{r}
#| fig-align: center
ggplot(data = penguins,
       aes(x = species,
           y = bill_depth_mm))+
  geom_point()
```

## Resposta

```{r}
#| fig-align: center
ggplot(data = penguins,
       aes(x = species,
           y = bill_depth_mm))+
  geom_boxplot()
```

## Exercícios

Recrie a seguinte visualização. Para qual estética o bill_depth_mm deve ser mapeado? E deve ser mapeado no nível global ou no nível geom?

```{r}
#| echo: false
#| fig-align: center
#| out-width: 50%

ggplot(data = penguins,
       aes(x = flipper_length_mm,
           y = body_mass_g))+
  geom_point(aes(color = bill_depth_mm))+
  geom_smooth()
```

## Resposta

```{r}
#| fig-align: center
#| out-width: 70%
#| output-location: slide

ggplot(data = penguins,
       aes(x = flipper_length_mm,
           y = body_mass_g))+
  geom_point(aes(color = bill_depth_mm))+
  geom_smooth()
```

## 2.3 Chamadas do ggplot2


